<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tg.base.tb.mapper.TbBotInstanceManagerMapper">

    <resultMap id="BaseResultMap" type="com.tg.base.tb.entity.TbBotInstanceManager">
        <id property="tbBotInstanceId" column="tb_bot_instance_id" jdbcType="INTEGER"/>
        <result property="tgBotCreateUserId" column="tg_bot_create_user_id" jdbcType="VARCHAR"/>
        <result property="tgBotGsUserId" column="tg_bot_gs_user_id" jdbcType="VARCHAR"/>
        <result property="botUserName" column="bot_user_name" jdbcType="VARCHAR"/>
        <result property="botToken" column="bot_token" jdbcType="VARCHAR"/>
        <result property="botNo" column="bot_no" jdbcType="VARCHAR"/>
        <result property="botRemark" column="bot_remark" jdbcType="VARCHAR"/>
        <result property="botQyStatus" column="bot_qy_status" jdbcType="INTEGER"/>
        <result property="runStatus" column="run_status" jdbcType="INTEGER"/>
        <result property="createUser" column="create_user" jdbcType="VARCHAR"/>
        <result property="createTime" column="create_time" jdbcType="TIMESTAMP"/>
        <result property="updateUser" column="update_user" jdbcType="VARCHAR"/>
        <result property="updateTime" column="update_time" jdbcType="TIMESTAMP"/>
    </resultMap>

    <sql id="Base_Column_List">
        tb_bot_instance_id,tg_bot_create_user_id,tg_bot_gs_user_id,
        bot_user_name,bot_token,bot_no,
        bot_remark,bot_qy_status,run_status,
        create_user,create_time,update_user,
        update_time
    </sql>


    <update id="updateRunStatusByBotTypeId">
        UPDATE tb_bot_instance_manager
        SET run_status = #{runStatus}
        where tb_bot_instance_id = #{tbBotInstanceId}
        ;
    </update>
    <update id="updateQyStatusAndRunStatusByBotTypeId">
        UPDATE tb_bot_instance_manager
        SET bot_qy_status = #{qyStatus},run_status = #{runStatus}
        where tb_bot_instance_id = #{tbBotInstanceId}
    </update>
    <delete id="deleteBotByBotName" parameterType="java.lang.String">
        delete from tb_bot_instance_manager
        where bot_user_name = #{botName}
    </delete>


    <select id="selectAllBotPageByConditionAdmin"
            resultType="com.tg.base.tb.entity.TbBotInstanceManager">

        select

        tb_bot_instance_id AS tbBotInstanceId,

        bot_user_name AS botUserName,
        bot_token as botToken,
        bot_no AS botNo,

        bot_remark AS botRemark,
        bot_qy_status AS botQyStatus,
        run_status AS runStatus,

        create_user AS createUser,
        create_time AS createTime,
        update_user AS updateUser,
        update_time AS updateTime

        from tb_bot_instance_manager
        where 1 = 1

        <if test="botTypeId !=null and botTypeId!=0">
            and tb_bot_type_id = #{botTypeId}
        </if>

        <if test="botUserName!=null and botUserName!='' ">
            and bot_user_name like '%' #{botUserName} '%'
        </if>

        <if test="botToken!=null and botToken!='' ">
            and bot_token like '%' #{botToken} '%'
        </if>

        <if test="botNo!=null and botNo!='' ">
            and bot_no like '%' #{botNo} '%'
        </if>

        <if test="botQyStatus !=null and botQyStatus!=0">
            and bot_qy_status = #{botQyStatus}
        </if>

        <if test="runStatus !=null and runStatus!=0">
            and run_status = #{runStatus}
        </if>


    </select>
    <select id="selectBotByQyStatus" resultType="com.tg.base.tb.entity.TbBotInstanceManager"
            parameterType="int">
        select

            tb_bot_instance_id AS tbBotInstanceId,

            bot_user_name AS botUserName,
            bot_token as botToken,
            bot_no AS botNo,

            bot_remark AS botRemark,
            bot_qy_status AS botQyStatus,
            run_status AS runStatus,

            create_user AS createUser,
            create_time AS createTime,
            update_user AS updateUser,
            update_time AS updateTime

        from tb_bot_instance_manager
        where 1 = 1
          and bot_qy_status = #{qyStatus}
    </select>
    <select id="selectOneByBotIdAndUserTgId"
            resultType="com.tg.base.tb.entity.TbBotInstanceManager">
        select

            tb_bot_instance_id AS tbBotInstanceId,
            tg_bot_gs_user_id as tgBotGsUserId,

            bot_user_name AS botUserName,
            bot_token as botToken,
            bot_no AS botNo,

            bot_remark AS botRemark,
            bot_qy_status AS botQyStatus,
            run_status AS runStatus,

            create_user AS createUser,
            create_time AS createTime,
            update_user AS updateUser,
            update_time AS updateTime

        from tb_bot_instance_manager
        where 1 = 1
          and tb_bot_instance_id = #{botId}
          and tg_bot_gs_user_id = #{userTgId}
    </select>
    <select id="selectByToken" resultType="com.tg.base.tb.entity.TbBotInstanceManager"
            parameterType="java.lang.String">
        select
            tb_bot_instance_id,tg_bot_create_user_id,tg_bot_gs_user_id,
            bot_user_name,bot_token,bot_no,
            bot_remark,bot_qy_status,run_status,
            create_user,create_time,update_user,
            update_time
        from tb_bot_instance_manager
        where 1 = 1
          and bot_token = #{botToken}
    </select>
    <select id="selectByBotName" resultType="com.tg.base.tb.entity.TbBotInstanceManager"
            parameterType="java.lang.String">
        select
            tb_bot_instance_id,tg_bot_create_user_id,tg_bot_gs_user_id,
            bot_user_name,bot_token,bot_no,
            bot_remark,bot_qy_status,run_status,
            create_user,create_time,update_user,
            update_time
        from tb_bot_instance_manager
        where 1 = 1
          and bot_user_name = #{botName}
    </select>
    <select id="selectByGsUserId" resultType="com.tg.base.tb.entity.TbBotInstanceManager">
        select
            tb_bot_instance_id,tg_bot_create_user_id,tg_bot_gs_user_id,
            bot_user_name,bot_token,bot_no,
            bot_remark,bot_qy_status,run_status,
            create_user,create_time,update_user,
            update_time
        from tb_bot_instance_manager
        where 1 = 1
          and tg_bot_gs_user_id = #{userId}
    </select>


</mapper>
